<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
    <!--
    ==================================
    Chequeras
    ==================================
    -->

        <record id="view_check_book_filter" model="ir.ui.view">
            <field name="name">check.book.select</field>
            <field name="model">check.book</field>
            <field name="type">search</field>
            <field name="arch" type="xml">
                <search string="Search Check Book">
                    <group col="10" colspan="4">
                        <filter name="request" icon="terp-gtk-media-pause" string="Request" domain="[('state','=','request')]" help="Request check book"/>                    
                        <filter name="draft" icon="terp-document-new" string="Draft" domain="[('state','=','draft')]" help="Draft check book"/>
                        <filter name="review" icon="terp-camera_test" string="Review" domain="[('state','=','review')]" help="Review check book"/>
                        <filter name="cancel" icon="terp-dialog-close" string="Cancel" domain="[('state','=','cancel')]" help="Cancel check book"/>
                        <filter name="active" icon="terp-check" string="Active" domain="[('state','=','active')]" help="Active check book"/>                                                
                        <separator orientation="vertical"/>
                        <field name="name"/>                        
                        <field name="cancel_check" widget="selection"/>                        
                        <field name="accounting_bank_id"/>
                        <field name="bank_id"/>
                        <field name="qty_check_selection" widget="selection"/>
                        <field  name="state"/>
                        
                    </group>
                    <newline/>
                    <group expand="0" string="Group By...">
                        <filter string="Bank" icon="terp-folder-green" domain="[]" context="{'group_by':'bank_id'}"/>
                        <filter string="Bank Account" icon="terp-folder-orange" domain="[]" context="{'group_by':'accounting_bank_id'}"/>
                        <separator orientation="vertical"/>
                        <filter string="State" icon="terp-stock_effects-object-colorize" domain="[]"  context="{'group_by':'state'}"/>
                    </group>
               </search>
            </field>
        </record>

    
        <record id="view_check_book_form" model="ir.ui.view">
            <field name="name">check.book.form</field>
            <field name="model">check.book</field>
            <field name="type">form</field>
            <field name="arch" type="xml">
                <form string="Chequeras">
                    <group colspan="4" col="6">
                        <field name="name"/>
                        <field name="accounting_bank_id"/>
                        <field name="bank_id"/>
                        <field name="from_suffix"/>
                        <field name="to_suffix"/>
                        <field name="date_draft"/>
                        <field name="date_active"/>
                        <field name="date_done"/>
                        <field name="qty_check_selection"/>
                        <field name="fixed_prefix"/>
                    </group>
                    <group attrs="{'invisible':[('fixed_prefix','=',False)]}" colspan="2" col='6'>                        
                        <field name="prefix"/>
                        <hpaned/>
                        <hpaned/>
                        <hpaned/>
                        <hpaned/>
                     </group>
                    <notebook colspan="4">
                        <page string="Cheques">
                            <field name="check_note_ids" nolabel="1">
                                <tree string="Cheques" editable='top' >
                                    <field name="number" attrs="{'required':[('state','!=','draft')],'readonly':[('state','!=','draft')]}"/>
                                    <field name="suffix" attrs="{'required':[('state','!=','draft')],'readonly':[('state','!=','draft')]}"/>
                                    <field name="prefix" attrs="{'required':[('state','!=','draft')],'readonly':[('state','!=','draft')]}"/>
                                    <field name="state"/>
                                </tree>
                                 
                                 <form>
                                    <field name="number" attrs="{'required':[('state','!=','draft')],'readonly':[('state','!=','draft')]}"/>
                                    <field name="suffix" attrs="{'required':[('state','!=','draft')],'readonly':[('state','!=','draft')]}"/>
                                    <field name="prefix" attrs="{'required':[('state','!=','draft')],'readonly':[('state','!=','draft')]}"/>
                                    <field name="state"/>
                                 </form>

                            </field>
                        </page>
                        <page string="Otra Informacion">
                           <group colspan="4" col="6">
                                <field name="check_book_request_id"/>
                                <field name="cancel_check"/>
                           </group>
                           <group attrs="{'invisible':[('cancel_check','!=','otros')]}" colspan="5" col='6'>                        
                                <field name="notes"/>
                           </group>
                        <group colspan="2" col='6'>
                            <hpaned/><hpaned/>
                            <hpaned/><hpaned/>
                            <hpaned/>
                            <button name="%(report_check_book)d" states="active" string='Ver Reporte' type="action" icon='gtk-print' />  
                            <button name="%(report_check_book)d" states="done" string='Ver Reporte' type="action" icon='gtk-print' />   
                        </group>

                        </page>
                    </notebook>
                   <group colspan="2" col='6'>
                        <hpaned/>
                        <hpaned/>
                        <hpaned/>
                       <field  name="state" />
                        <newline/>
                        <button name="anular" states="active, hibernate" string="Cancelar" type="object" icon="gtk-cancel"/>
                        <button name="review" states="draft" string="Cargar Cheques" type="object" icon="gtk-convert"/>
                        <button name="active" states="review" string="Active" type="object" icon="gtk-execute"/>
                        <button name="hibernate" states="active" string="Hibernar" type="object" icon="gtk-execute"/>
                        <button name="active_hibernate" states="hibernate" string="Reactivar" type="object" icon="gtk-execute"/>
                  </group>
                </form>
            </field>
        </record>
        <record id="view_check_book_tree" model="ir.ui.view">
            <field name="name">check.book.tree</field>
            <field name="model">check.book</field>
            <field name="type">tree</field>
            <field name="arch" type="xml">
            <tree string="Chequeras" colors="green:state=='draft';red:qty_active&lt;10 ;blue:state=='hibernate';gray:state=='done' or state=='cancel'">
<!--            <tree string="Chequeras" colors="green:state=='draft';red:qty_active&lt;10 ;blue:state=='hibernate';gray:state=='done' or state=='cancel' ;purple:state=='active' and qty_active&gt;9 ">-->
                    <field name="name" select="1" />                 
                    <field name="accounting_bank_id" select="1" />
                    <field name="bank_id" select="1" />
                    <field name="from_suffix"/>                    
                    <field name="to_suffix"/>
                    <field name="fixed_prefix"/>
                    <field name="prefix"/>
                    <field name="state"/>
                    <field name="date_draft"/>
                    <field name="date_active"/>
                    <field name="date_done"/>
                    <field name="qty_check"/>
                    <field name="qty_active"/>
                    <field name="rate_user" widget="progressbar"/>
                </tree>
            </field>
        </record>
        <record id="action_check_book" model="ir.actions.act_window">
            <field name="name">Chequeras</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">check.book</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
	    	<field name="search_view_id" ref="view_check_book_filter"/>
            <field name="help">With Check Book you can create and manage Check Book.</field>            
        </record>
        <menuitem 
            name="Gestion de Chequeras" 
            id="id_check_book" 
            parent="menu_check"
            sequence="99"/>
        <menuitem 
            action="action_check_book" 
            id="menu_check_book" 
            parent="id_check_book"/>
    </data>
</openerp>
