<?xml version="1.0"?>
<document filename="test.pdf" invariant="1">
  <template pageSize="(825.0,612.0)" title="Test" author="Martin Simon" allowSplitting="20" showBoundary="0">
    <pageTemplate id="first">
        
        <pageGraphics>
            <setFont name="Helvetica" size="9"/>
            <drawString x="1.3cm" y="0.5cm"> [[ formatLang(time.strftime("%Y-%m-%d %H:%M:%S", time.localtime()),date_time = True) ]]</drawString>
            <drawString x="25cm" y="0.5cm">Pagina <pageNumber/></drawString>
            <lineMode width="0.7"/>
            <lines>1.3cm 24.9cm 38.3cm 24.9cm</lines>
            <setFont name="Helvetica" size="8"/>
        </pageGraphics>
    <frame id="first" x1="15.0" y1="15.0" width="793" height="580"/>
    </pageTemplate>
    
    
  </template>
  <stylesheet>
    <blockTableStyle id="Standard_Outline">
      <blockAlignment value="LEFT"/>
      <blockValign value="TOP"/>
    </blockTableStyle>
    <blockTableStyle id="HEADERTABLE">
      <blockAlignment value="LEFT"/>
      <blockValign value="TOP"/>
      <lineStyle kind="LINEBELOW" colorName="#000000" thickness="1" start="0,0" stop="14,0"/>
    </blockTableStyle>
    <blockTableStyle id="HEADERTABLE_AD">
      <blockAlignment value="LEFT"/>
      <blockValign value="TOP"/>
      <lineStyle kind="LINEBELOW" colorName="#000000" thickness="1" start="0,3" stop="14,3"/>
    </blockTableStyle>
    <blockTableStyle id="INTERNALTABLE">
      <blockAlignment value="LEFT"/>
      <blockValign value="MIDDLE"/>
    </blockTableStyle>
    <blockTableStyle id="CONTENIDOTABLE">
      <blockAlignment value="LEFT"/>
      <blockValign value="MIDDLE"/>
        <lineStyle kind="GRID" colorName="black" thickness="1" start="1,1" stop="-1,-1"/>
        <lineStyle kind="GRID" colorName="black" thickness="1" start="-4,0" stop="-3,0"/>
    </blockTableStyle>
    <blockTableStyle id="CONTENIDOTABLE_PUR">
      <blockAlignment value="LEFT"/>
      <blockValign value="MIDDLE"/>
        <lineStyle kind="GRID" colorName="black" thickness="1" start="0,1" stop="-1,-1"/>
        <lineStyle kind="GRID" colorName="black" thickness="1" start="-4,0" stop="-3,0"/>
    </blockTableStyle>
    <blockTableStyle id="CONTENIDOTABLE_TITULOS">
        <blockAlignment value="LEFT"/>
        <blockValign value="MIDDLE"/>
        <lineStyle kind="GRID" colorName="black" start="1,0" stop="-1,-1" thickness="0.5"/>
        <blockBackground colorName="#e5e2e5" start="1,0" stop="-1,0"/>
    </blockTableStyle>
    <blockTableStyle id="CONTENIDOTABLE_TITULOS_PUR">
        <blockAlignment value="LEFT"/>
        <blockValign value="MIDDLE"/>
        <lineStyle kind="GRID" colorName="black" start="0,0" stop="-1,-1" thickness="0.5"/>
        <blockBackground colorName="#e5e2e5" start="0,0" stop="-1,0"/>
    </blockTableStyle>
    <blockTableStyle id="CONTENIDOTABLE_LINES">
        <blockAlignment value="LEFT"/>
        <blockValign value="MIDDLE"/>
        <lineStyle kind="GRID" colorName="black" start="1,0" stop="-1,-1" thickness="0.5"/>
    </blockTableStyle>
    <blockTableStyle id="CONTENIDOTABLE_LINES_PUR">
        <blockAlignment value="LEFT"/>
        <blockValign value="MIDDLE"/>
        <lineStyle kind="GRID" colorName="black" start="0,0" stop="-1,-1" thickness="0.5"/>
    </blockTableStyle>
    
    <initialize>
      <paraStyle name="all" alignment="justify"/>
      <alias id="style.normal" value="style.Normal"/>
    </initialize>
    <paraStyle name="P1" fontName="Helvetica" fontSize="6.0" leading="8" alignment="CENTER"/>
    <paraStyle name="P2" fontName="Helvetica" fontSize="6.0" leading="8" alignment="CENTER"/>
    <paraStyle name="P3" fontName="Helvetica" fontSize="6.0" leading="8" alignment="CENTER"/>
    <paraStyle name="P4" fontName="Helvetica" fontSize="6.0" leading="8" alignment="CENTER" textColor="#ffffff"/>
    <paraStyle name="P5" fontName="Helvetica" fontSize="6.0" leading="8"/>
    <paraStyle name="CONTENIDO" fontName="Helvetica" fontSize="6.0" leading="6" alignment="CENTER"/>
    <paraStyle name="TITULO_AJUSTE" fontName="Helvetica" fontSize="10.0" alignment="CENTER"/>
    <paraStyle name="CONTENIDOINT" fontName="Helvetica" fontSize="6.0" leading="1" alignment="CENTER"/>
    <paraStyle name="CONTENIDOLEFT" fontName="Helvetica" fontSize="6.0" leading="6" alignment="LEFT"/>
    <paraStyle name="OBSERVACIONES" fontName="Helvetica" fontSize="9.0"  alignment="LEFT"/>
    <paraStyle name="HEADERDOC" fontName="Helvetica-bold" fontSize="8.0" leading="8" alignment="JUSTIFY"/>
    <paraStyle name="HEADER" fontName="Helvetica-bold" fontSize="6.0" leading="6" alignment="CENTER"/>
    <paraStyle name="CONTENIDOLEFT_BOLD" fontName="Helvetica-bold" fontSize="6.0" leading="6" alignment="LEFT"/>
    <paraStyle name="P7" fontName="Helvetica" fontSize="6.0" leading="8" alignment="CENTER"/>
    <paraStyle name="P8" fontName="Helvetica" fontSize="6.0" leading="8" alignment="CENTER" textColor="#ffffff"/>
    <paraStyle name="Standard" fontName="Times-Roman"/>
    <paraStyle name="Heading" fontName="Helvetica" fontSize="14.0" leading="17" spaceBefore="12.0" spaceAfter="6.0"/>
    <paraStyle name="Text body" fontName="Times-Roman" spaceBefore="0.0" spaceAfter="6.0"/>
    <paraStyle name="List" fontName="Times-Roman" spaceBefore="0.0" spaceAfter="6.0"/>
    <paraStyle name="Caption" fontName="Times-Roman" fontSize="12.0" leading="15" spaceBefore="6.0" spaceAfter="6.0"/>
    <paraStyle name="Index" fontName="Times-Roman"/>
    <paraStyle name="Table Contents" fontName="Times-Roman"/>
    <paraStyle name="Table Heading" fontName="Times-Roman" alignment="CENTER"/>
    <paraStyle name="h1" fontName="Helvetica-BoldOblique" fontSize="32" leading="36"/>
    <paraStyle name="normal" fontName="Helvetica" fontSize="10" leading="12"/>
    <paraStyle name="normal_indent" parent="normal" leftIndent="36"/>
  </stylesheet>
  <images/>
  <story>
    
<!--
    <para style="normal"></para>
    <para style="normal_indent"><seq id="level_1"/></para>
    <para style="normal_indent"><seq id="level_1"/></para>
-->
    
    <blockTable colWidths="350.0,190.0,220.0" style="HEADERTABLE">
      <tr>
        [[ setLang(l.ai_id.company_id.partner_id.lang) ]]
        <td>
          <para style="HEADERDOC">[[ company.partner_id.name ]] [[ company.partner_id.vat[2:] ]]</para>
          <para style="HEADERDOC">[[ get_partner_addr( company.partner_id.id ) ]]</para>
        </td>
        <td>
          <para style="HEADERDOC">Libro: [[ (data['form']['type'] == 'purchase') and "Compras"or "Ventas" ]] </para>
          <para style="HEADERDOC">Correspodiente al Mes de [[ get_month( data['form'] )[0] ]] del año [[ get_month( data['form'] )[1] ]]</para>
          <para style="HEADERDOC">[[data['form'] and ('Desde: %s'%formatLang( data['form']['date_start'], date=True)) or '']]</para>
          <para style="HEADERDOC">[[data['form'] and ('Hasta: %s'%formatLang( data['form']['date_end'], date=True)) or '']]</para>
        </td>
        <td>
          <para style="HEADERDOC" fontName="Helvetica">Según Articulo 76 del Reglamento de la Ley del IVA No. 5.363 del 12 de Julio de 1999</para>
        </td>
      </tr>
    </blockTable>
    <spacer length="2mm"/>
          <!-- ****************************************-->
          <!-- ********* SALE, PURCHASE, BOOK *********-->
          <!-- ****************************************-->
    <section>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE" repeatRows="2">
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE', 'repeatRows':'2'}) or '']]
        <tr>
            <td></td><td></td><td></td>
            <td></td><td></td><td></td>
            <td></td><td></td><td></td>
            <td></td>
            <td>
                <blockTable colWidths="110.0" style="INTERNALTABLE">
                    <tr><td vAlign="MIDDLE"><para style="HEADER">Operaciones Nacionales</para></td></tr>
                </blockTable>
            </td>
            <td>
                <blockTable colWidths="110.0" style="INTERNALTABLE">
                    <tr><td vAlign="MIDDLE"><para style="HEADER">Operaciones Internacionales</para></td></tr>
                </blockTable>
            </td>
            <td></td><td></td>
        </tr>
        </blockTable>
    </section>
    
    <section>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_TITULOS" repeatRows="2">
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_TITULOS_PUR', 'repeatRows':'2'}) or '']]
        <tr>
            <td><para style="HEADER">[[ (data['form']['type'] == 'purchase') and 'Fecha Adm.' or '' ]]</para></td>
            <td><para style="HEADER">Fecha Cont.</para></td>
            <td><para style="HEADER">RIF</para></td>
            <td><para style="HEADER">Razon Social</para></td>
            <td><para style="HEADER">Numero Doc.</para></td>
            <td><para style="HEADER">Numero Control</para></td>
            <td><para style="HEADER">Total con IVA</para></td>
            <td><para style="HEADER">T. Doc.</para></td>
            <td><para style="HEADER">Documento Afectado</para></td>
            <td><para style="HEADER">Sin derecho a Credito Fiscal</para></td>
            <td>
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="HEADER">Base Imponible</para></td>
                        <td><para style="HEADER">%</para><para style="HEADER">IVA</para></td>
                        <td><para style="HEADER">Monto</para><para style="HEADER">Impuesto</para></td>
                    </tr>
                </blockTable>
            </td>
            <td>
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="HEADER">Base Imponible</para></td>
                        <td><para style="HEADER">%</para><para style="HEADER">IVA</para></td>
                        <td><para style="HEADER">Monto</para><para style="HEADER">Impuesto</para></td>
                    </tr>
                </blockTable>
            </td>
            <td><para style="HEADER">Retencion Iva</para></td>
            <td><para style="HEADER">Comprobante</para></td>
        </tr>
        </blockTable>
    </section>


    <!-- ************ WITHHOLDING VAT BOOK LINES************-->
    <section>
        <para>[[repeatIn( get_data_wh(data['form']),'wh')]]</para>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_LINES" repeatRows="2">        
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_LINES_PUR', 'repeatRows':'2'}) or '']]
        <tr>
            <para>[[ (data['form']['type'] == 'sale') and '.' or removeParentNode('blockTable') ]]</para>
            [[ setLang(company.partner_id.lang) ]]
            <td><para style="CONTENIDO">[[ (data['form']['type'] == 'purchase') and wh.ai_id.date_document or '' ]]</para></td>
            <td><para style="CONTENIDO">[[ time.strftime('%d/%m/%Y', time.strptime(wh.ar_date_ret, '%Y-%m-%d'))]]</para></td>
            <td><para style="CONTENIDO">[[ get_rif(wh.rp_vat) ]]</para></td>
            <td><para style="CONTENIDOLEFT">[[ wh.rp_id.name ]]</para></td>
            <td><para style="CONTENIDO">-----</para></td>
            <td><para style="CONTENIDO">-----</para></td>
            <td><para style="CONTENIDO">0.00</para></td>
            <td><para style="CONTENIDO">-</para></td>
            <td><para style="CONTENIDO">-----</para></td>
            <td><para style="CONTENIDO">0.00</para></td>
            <td>
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="CONTENIDO">0.00</para></td>
                        <td><para style="CONTENIDO">0.00</para></td>
                        <td><para style="CONTENIDO">0.00</para></td>
                    </tr>
                </blockTable>
            </td>
            <td>
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="CONTENIDO">0.00</para></td>
                        <td><para style="CONTENIDO">0.00</para></td>
                        <td><para style="CONTENIDO">0.00</para></td>
                    </tr>
                </blockTable>
            </td>
            <td><para style="CONTENIDO">[[ formatLang(get_amount_withheld(wh.ar_line_id.id)) or '' ]]</para></td>
            <td><para style="CONTENIDO">[[ wh.ar_id.number ]]</para></td>
        </tr>
        </blockTable>
    </section>


    <!-- ************ PURCHASE, SALE, BOOK LINES************-->
    <section>
        <para>[[repeatIn( get_data( data['form'] ),'l')]]</para>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_LINES" repeatRows="2">
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_LINES_PUR', 'repeatRows':'2'}) or '']]
        <tr>
            [[ setLang(l.ai_id.company_id.partner_id.lang) ]]
            <td><para style="CONTENIDO">[[ data['form']['type'] == 'purchase' and ( l.ai_id.date_document and formatLang(l.ai_id.date_document, date=True) or '') or '' ]]</para></td>
            <td><para style="CONTENIDO">[[ time.strftime('%d/%m/%Y', time.strptime(l.ai_date_invoice, '%Y-%m-%d')) ]]</para></td>
            <td><para style="CONTENIDO">[[ ("PAPELANULADO" not in l.ai_id.name) and l.rp_id.vat[2:] or '-----' ]]</para></td>
            <td><para style="CONTENIDOLEFT">[[ ("PAPELANULADO" not in l.ai_id.name) and l.rp_id.name or 'ANULADO' ]]</para></td>
            <td><para style="CONTENIDO">[[ ("PAPELANULADO" not in l.ai_id.name) and l.ai_reference or '-----' ]]</para></td>
            <td><para style="CONTENIDO">[[ l.ai_id.nro_ctrl ]]</para></td>
            <td><para style="CONTENIDO">[[ formatLang((l.ai_id.type in ['in_refund', 'out_refund']) and l.ai_amount_total*(-1) or l.ai_amount_total) ]]</para></td>
            <td><para style="CONTENIDO">[[ get_doc(l.ai_id.id) ]]</para></td>
            <td><para style="HEADER">[[ (data['form']['type'] == 'purchase') and l.ai_id.parent_id.reference or l.ai_id.parent_id.number ]]</para></td>
            <td><para style="CONTENIDO">[[ formatLang(get_v_sdcf(l)) ]]</para></td>
            <td>  
                <section>
                    <para>[[ repeatIn(get_taxes(l) and get_taxes(l) or [0.0],'s')]]</para> 
                    <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                        <tr>
                            <td><para style="CONTENIDOINT">[[ formatLang((get_p_country(company.partner_id.id) == get_p_country(s.invoice_id.partner_id.id)) and get_tax_line(s) or 0.0) ]]</para></td>
                            <td><para style="CONTENIDOINT">[[ formatLang((get_p_country(company.partner_id.id) == get_p_country(s.invoice_id.partner_id.id)) and round(s.tax_amount/(s.base_amount and s.base_amount or 1)*100.0) or 0.0) ]]</para></td>
                            <td><para style="CONTENIDOINT">[[ formatLang((get_p_country(company.partner_id.id) == get_p_country(s.invoice_id.partner_id.id)) and s.tax_amount or 0.0) ]]</para></td>
                        </tr>
                    </blockTable>
                </section>
            </td>
            <td>
            <section>
            <para>[[ repeatIn(get_taxes(l) and get_taxes(l) or [0.0],'t')]]</para> 
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="CONTENIDOINT">[[ formatLang((get_p_country(company.partner_id.id) != get_p_country(t.invoice_id.partner_id.id)) and get_tax_line(t) or 0.0) ]]</para></td>
                        <td><para style="CONTENIDOINT">[[ formatLang((get_p_country(company.partner_id.id) != get_p_country(t.invoice_id.partner_id.id)) and t.tax_amount/(t.base_amount and t.base_amount or 1)*100.0 or 0.0) ]]</para></td>
                        <td><para style="CONTENIDOINT">[[ formatLang((get_p_country(company.partner_id.id) != get_p_country(t.invoice_id.partner_id.id)) and t.tax_amount or 0.0) ]]</para></td>
                    </tr>
                </blockTable>
            </section>
            </td>
            <td><para style="CONTENIDO">[[ get_date_wh(data['form'],l) and (get_ret(data['form'], l.ar_id and l.ar_id.id) and (formatLang(((l.ai_id.type in ['in_refund', 'out_refund']) and (get_amount_withheld(l.ar_line_id.id)*(-1)) or get_amount_withheld(l.ar_line_id.id)))) or '') or '']]</para></td>
            <td><para style="CONTENIDO">[[ get_date_wh(data['form'],l) and (get_ret(data['form'],l.ar_id and l.ar_id.id) and l.ar_id.number or '') or '' ]]</para></td>
        </tr>
        </blockTable>
    </section>
    
        <!-- ************ TOTALS PURCHASE,SALE PARCIALES************-->
    <section>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_LINES" repeatRows="2">
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_LINES_PUR', 'repeatRows':'2'}) or '']]
        <tr>
            [[ setLang(l.ai_id.company_id.partner_id.lang) ]]
            <td></td><td></td>
            <td></td><td></td>
            <td></td><td></td>
            <td><para style="CONTENIDO">[[ formatLang(get_total_iva(data['form'])) ]]</para></td>
            <td></td><td></td>
            <td><para style="CONTENIDO">[[ formatLang(get_amount_untaxed_tax(data['form'],'SDCF','nacional')[0])]]</para></td>
            <td>
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="HEADER">[[ formatLang(get_amount_untaxed_tax(data['form'],'12','nacional')[0]+get_amount_untaxed_tax(data['form'],'8','nacional')[0]+get_amount_untaxed_tax(data['form'],'EXONERADO','nacional')[0]) ]]</para></td>
                        <td></td>
                        <td><para style="HEADER">[[ formatLang(get_amount_untaxed_tax(data['form'],'12','nacional')[1] +get_amount_untaxed_tax(data['form'],'8','nacional')[1]+get_amount_untaxed_tax(data['form'],'EXONERADO','nacional')[1]) ]]</para></td>
                    </tr>
                </blockTable>
            </td>
            <td>
                <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                    <tr>
                        <td><para style="HEADER">[[ formatLang(get_amount_untaxed_tax(data['form'],'12')[0]+get_amount_untaxed_tax(data['form'],'8')[0]+get_amount_untaxed_tax(data['form'],'EXONERADO')[0]) ]]</para></td>
                        <td></td>
                        <td><para style="HEADER">[[ formatLang(get_amount_untaxed_tax(data['form'],'12')[1] +get_amount_untaxed_tax(data['form'],'8')[1]+get_amount_untaxed_tax(data['form'],'EXONERADO')[1]) ]]</para></td>
                    </tr>
                </blockTable>
            </td>
            <td><para style="CONTENIDO">[[ formatLang(get_total_wh(data['form'])) ]]</para></td>
            <td></td>
        </tr>
        </blockTable>
    </section>

    <!-- ************ LEYENDA************-->
    <section>
        <blockTable colWidths="794.0">
            <tr>
                <td><para style="CONTENIDOLEFT">LEYENDA. F:Factura, ND:Nota de Débito, NC:Nota de Crédito, E:Expediente</para></td>
            </tr>
        </blockTable>
    </section>

    <spacer length='5mm'/>
    <!-- ************ TOTALS SALE/PURCHASE BOOK************-->
    <section>
        <blockTable colWidths="280.0,80.0,80.0" style="CONTENIDOTABLE_TITULOS_PUR" repeatRows="2">
            <tr>
                <td><para style="HEADER">[[data['form']['type'] == 'purchase' and 'CREDITOS FISCALES' or 'DEBITOS FISCALES']]</para></td>
                <td><para style="HEADER">BASE IMPONIBLE</para></td>
                <td><para style="HEADER">[[data['form']['type'] == 'purchase' and 'CREDITO FISCAL' or 'DEBITO FISCAL']]</para></td>
            </tr>
        </blockTable>
    </section>
    
    <section>
        [[ setLang(l.ai_id.company_id.partner_id.lang) ]]
        <blockTable colWidths="280.0,80.0,80.0" style="CONTENIDOTABLE_LINES_PUR" repeatRows="2">
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'COMPRAS NO GRAVADAS Y/O SIN DERECHO A CREDITO FISCAL' or 'DEBITOS FISCALES']]</para></td>
                <td><para style="CONTENIDO">[[ formatLang(get_amount_untaxed_tax(data['form'],'SDCF','nacional')[0]+get_amount_untaxed_tax(data['form'],'EXONERADO','nacional')[0]+get_amount_untaxed_tax(data['form'],'SDCF')[0]+get_amount_untaxed_tax(data['form'],'EXONERADO')[0]) ]]</para></td>
                <td><para style="CONTENIDO"></para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'IMPORTACION GRAVADAS POR ALICUOTA GENERAL' or removeParentNode('tr')]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'12')[0])]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'12')[1])]]</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'IMPORTACIONES GRAVADAS POR ALICUOTA GENERAL MAS ALICUOTA ADICIONAL' or removeParentNode('tr')]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'22')[0])]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'22')[1])]]</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'IMPORTACIONES GRAVADAS POR ALICUOTA REDUCIDA' or removeParentNode('tr')]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'8')[0])]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'8')[1])]]</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'sale' and 'VENTAS DE EXPORTACION' or removeParentNode('tr')]]</para></td>
                <td><para style="CONTENIDO">0.0</para></td>
                <td><para style="CONTENIDO">0.0</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'COMPRAS GRAVADAS POR ALICUOTA GENERAL' or 'VENTAS INTERNAS GRAVADAS POR ALICUOTA GENERAL']]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'12','nacional')[0])]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'12','nacional')[1])]]</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'COMPRAS INTERNAS GRAVADAS POR ALICUOTA GENERAL MAS ALICUOTA ADICIONAL' or 'VENTAS INTERNAS GRAVADAS POR ALICUOTA GENERAL MAS ALICUOTA ADICIONAL']]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'22','nacional')[0])]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'22','nacional')[1])]]</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'COMPRAS INTERNAS GRAVADAS POR ALICUOTA REDUCIDA' or 'VENTAS INTERNAS GRAVADAS POR ALICUOTA REDUCIDA']]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'8','nacional')[0])]]</para></td>
                <td><para style="CONTENIDO">[[formatLang(get_amount_untaxed_tax(data['form'],'8','nacional')[1])]]</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT_BOLD">[[data['form']['type'] == 'purchase' and 'TOTAL COMPRAS Y CREDITOS FISCALES DEL PERIODO' or 'TOTAL VENTAS Y DEBITOS FISCAL PARA EFECTOS DE DETERMINACION']]</para></td>
                <td><para style="CONTENIDO">
[[ formatLang(get_amount_untaxed_tax(data['form'],'SDCF','nacional')[0]+
get_amount_untaxed_tax(data['form'],'EXONERADO','nacional')[0]+
get_amount_untaxed_tax(data['form'],'SDCF')[0]+
get_amount_untaxed_tax(data['form'],'EXONERADO')[0]+
get_amount_untaxed_tax(data['form'],'12')[0]+
get_amount_untaxed_tax(data['form'],'22')[0]+
get_amount_untaxed_tax(data['form'],'8')[0]+
get_amount_untaxed_tax(data['form'],'12','nacional')[0]+
get_amount_untaxed_tax(data['form'],'22','nacional')[0]+
get_amount_untaxed_tax(data['form'],'8','nacional')[0])]]
                </para></td>
                <td><para style="CONTENIDO">
[[formatLang(
get_amount_untaxed_tax(data['form'],'12')[1]+
get_amount_untaxed_tax(data['form'],'22')[1]+
get_amount_untaxed_tax(data['form'],'8')[1]+
get_amount_untaxed_tax(data['form'],'12','nacional')[1]+
get_amount_untaxed_tax(data['form'],'22','nacional')[1]+
get_amount_untaxed_tax(data['form'],'8','nacional')[1]
)]]
                </para></td>
            </tr>
        </blockTable>
    </section>

          <!-- ****************************************-->
          <!-- ************ AJUSTMENT BOOK ************-->
          <!-- ****************************************-->
    <section>
    <blockTable colWidths="795.0" style="HEADERTABLE_AD">
        <tr><td><para></para></td></tr>
        <tr><td><para></para></td></tr>
        <tr> 
            <para>[[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
            <td><para style="TITULO_AJUSTE">LIBRO DE AJUSTES</para></td></tr>
        <tr><td><para></para></td></tr>
    </blockTable>
    </section>


    <section>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE" repeatRows="2">
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_PUR', 'repeatRows':'2'}) or '']]
        <tr>
            <para>[[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
            <td></td><td></td><td></td>
            <td></td><td></td><td></td>
            <td></td><td></td><td></td>
            <td></td>
            <td>
                <blockTable colWidths="110.0" style="INTERNALTABLE">
                    <tr><td vAlign="MIDDLE"><para style="HEADER">Operaciones Nacionales</para></td></tr>
                </blockTable>
            </td>
            <td>
                <blockTable colWidths="110.0" style="INTERNALTABLE">
                    <tr><td vAlign="MIDDLE"><para style="HEADER">Operaciones Internacionales</para></td></tr>
                </blockTable>
            </td>
            <td></td><td></td>
        </tr>
        </blockTable>
    </section>

    <section>
        <para>[[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_TITULOS" repeatRows="2">        
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_TITULOS_PUR', 'repeatRows':'2'}) or '']]
            <tr>
                <para>[[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
                <td><para style="HEADER">[[ (data['form']['type'] == 'purchase') and 'Fecha Adm.' or '' ]]</para></td>
                <td><para style="HEADER">Fecha Cont.</para></td>
                <td><para style="HEADER">RIF</para></td>
                <td><para style="HEADER">Razon Social</para></td>
                <td><para style="HEADER">Numero Doc.</para></td>
                <td><para style="HEADER">Numero Control</para></td>
                <td><para style="HEADER">Total con IVA</para></td>
                <td><para style="HEADER">Tipo Doc.</para></td>
                <td><para style="HEADER">Documento Afectado</para></td>
                <td><para style="HEADER">Sin derecho a Credito Fiscal</para></td>
                <td>
                    <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                        <tr>
                            <td><para style="HEADER">Base Imponible</para></td>
                            <td><para style="HEADER">%</para><para style="HEADER">IVA</para></td>
                            <td><para style="HEADER">Monto</para><para style="HEADER">Impuesto</para></td>
                        </tr>
                    </blockTable>
                </td>
                <td>
                    <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                        <tr>
                            <td><para style="HEADER">Base Imponible</para></td>
                            <td><para style="HEADER">%</para><para style="HEADER">IVA</para></td>
                            <td><para style="HEADER">Monto</para><para style="HEADER">Impuesto</para></td>
                        </tr>
                    </blockTable>
                </td>
                <td><para style="HEADER">Retencion IVA</para></td>
                <td><para style="HEADER">Comprobante</para></td>
            </tr>
        </blockTable>
    </section>

    <section>
    <para>[[ repeatIn(validation(data['form']) and get_data_adjustment(data['form'])[1] or [],'a')]]</para>  
    <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_LINES" repeatRows="2">        
    [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_LINES_PUR', 'repeatRows':'2'}) or '']]
    <tr>
        <para>[[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
        [[ setLang(l.ai_id.company_id.partner_id.lang) ]]
        <td><para style="CONTENIDO">[[ data['form']['type'] == 'purchase' and ( a.date_admin and formatLang(a.date_admin, date=True) or '') or '' ]]</para></td>
        <td><para style="CONTENIDO">[[ time.strftime('%d/%m/%Y', time.strptime(a.date_accounting, '%Y-%m-%d'))]]</para></td>
        <td><para style="CONTENIDO">[[ a.vat ]]</para></td>
        <td><para style="CONTENIDOLEFT">[[ a.partner ]]</para></td>
        <td><para style="CONTENIDO">[[ a.invoice_number ]]</para></td>
        <td><para style="CONTENIDO">[[ a.control_number ]]</para></td>
        <td><para style="CONTENIDO">[[ formatLang(a.amount) ]]</para></td>
        <td><para style="CONTENIDO">[[ a.type_doc ]]</para></td>
        <td><para style="CONTENIDO">[[ a.doc_affected ]]</para></td>
        <td><para style="CONTENIDO">[[ a.uncredit_fiscal ]]</para></td>
        <td>
            <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                <tr>
                    <td><para style="CONTENIDOINT">[[ formatLang(a.amount_untaxed_n) ]]</para></td>
                    <td><para style="CONTENIDOINT">[[ formatLang(a.percent_with_vat_n) ]]</para></td>
                    <td><para style="CONTENIDOINT">[[ formatLang(a.amount_with_vat_n) ]]</para></td>
                </tr>
            </blockTable>
        </td>
        <td>
            <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                <tr>
                    <td><para style="CONTENIDOINT">[[ formatLang(a.amount_untaxed_i) ]]</para></td>
                    <td><para style="CONTENIDOINT">[[ formatLang(a.percent_with_vat_i) ]]</para></td>
                    <td><para style="CONTENIDOINT">[[ formatLang(a.amount_with_vat_i) ]]</para></td>
                </tr>
            </blockTable>
        </td>
        <td><para style="CONTENIDO">[[ formatLang(a.amount_with_vat) ]]</para></td>
        <td><para style="CONTENIDO">[[ a.voucher ]]</para></td>
    </tr>
    </blockTable>
    </section>

    <section>
        <para>[[repeatIn( get_data_adjustment( data['form'] )[0],'al')]]</para> 
        <blockTable colWidths="1.0,33.0,37.0,192.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0" style="CONTENIDOTABLE_LINES" repeatRows="2">
        [[(data['form']['type'] == 'purchase') and setTag('blockTable','blockTable',{'colWidths':"33.0,33.0,37.0,160.0,47.0,38.0,38.0,15.0,38.0,34.0,114.0,114.0,44.0,50.0",'style':'CONTENIDOTABLE_LINES_PUR', 'repeatRows':'2'}) or '']]
            <tr>
                <para>
                [[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
                [[ setLang(company.partner_id.lang) ]]
                <td></td><td></td><td></td>
                <td></td><td></td><td></td>
                <td><para style="CONTENIDOINT">[[ formatLang(al.amount_total) ]]</para></td>
                <td></td><td></td>
                <td><para style="CONTENIDOINT">[[ formatLang(al.uncredit_fiscal_total) ]]</para></td>
                <td>
                    <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                        <tr>
                            <td><para style="CONTENIDOINT">[[ formatLang(al.amount_untaxed_n_total) ]]</para></td>
                            <td></td>
                            <td><para style="CONTENIDOINT">[[ formatLang(al.amount_with_vat_n_total) ]]</para></td>
                        </tr>
                    </blockTable>
                </td>
                <td>
                    <blockTable colWidths="40.0,30.0,40.0" style="INTERNALTABLE">
                        <tr>
                            <td><para style="CONTENIDOINT">[[ formatLang(al.amount_untaxed_i_total) ]]</para></td>
                            <td></td>
                            <td><para style="CONTENIDOINT">[[ formatLang(al.amount_with_vat_i_total) ]]</para></td>
                        </tr>
                    </blockTable>
                </td>
                <td><para style="CONTENIDO">[[ formatLang(al.amount_with_vat_total) ]]</para></td>
                <td></td>
            </tr>
        </blockTable>
    </section>

    <spacer length='5mm'/>
    <!-- ************ TOTALES ADJUSTMENT BOOK************-->
    <section>
        <blockTable colWidths="280.0,80.0,80.0" style="CONTENIDOTABLE_TITULOS_PUR" repeatRows="2">        
            <tr>
                <para>[[ validation(data['form']) and '.' or removeParentNode('blockTable')]]</para>
                <td><para style="HEADER">CREDITOS FISCALES</para></td>
                <td><para style="HEADER">BASE IMPONIBLE</para></td>
                <td><para style="HEADER">CREDITO FISCAL</para></td>
            </tr>
        </blockTable>
    </section>
    
    <section>
        [[ validation(data['form']) and '.' or removeParentNode('blockTable')]]
        <blockTable colWidths="280.0,80.0,80.0" style="CONTENIDOTABLE_LINES_PUR" repeatRows="2">
            <tr>
                <td><para style="CONTENIDOLEFT">[[ data['form']['type'] == 'purchase' and 'COMPRAS NO GRAVADAS Y/O SIN DERECHO A CREDITO FISCAL' or 'DEBITOS FISCALES']]</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'IMPORTACION GRAVADAS POR ALICUOTA GENERAL' or 'VENTAS INTERNAS NO GRAVADAS']]</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">[[data['form']['type'] == 'purchase' and 'IMPORTACIONES GRAVADAS POR ALICUOTA GENERAL MAS ALICUOTA ADICIONA' or '']]</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">IMPORTACIONES GRAVADAS POR ALICUOTA REDUCIDA</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">COMPRAS GRAVADAS POR ALICUOTA GENERAL</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">COMPRAS INTERNAS GRAVADAS POR ALICUOTA GENERAL MAS ALICUOTA ADICIONAL</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">COMPRAS INTERNAS GRAVADAS POR ALICUOTA REDUCIDA</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">AJUSTES A LOS CREDITOS FISCALES DE LOS PERIODOS ANTERIORES</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
            <tr>
                <td><para style="CONTENIDOLEFT">TOTAL COMPRAS Y CREDITOS FISCALES DEL PERIODO</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
                <td><para style="CONTENIDO">0.00</para></td>
            </tr>
        </blockTable>
    </section>

    <spacer length='5mm'/>
    <!-- ************ OBSERVACIONES ADJUSTMENT BOOK************-->
    <section>
        <para>[[ repeatIn(validation(data['form']) and get_data_adjustment(data['form'])[0] or [],'ob')]]</para>  
        <blockTable colWidths="794.0" style="CONTENIDOTABLE_LINES_PUR">
            <tr>
                <td><para style="OBSERVACIONES">[[ob.note and 'OBSERVACIONES:' or removeParentNode('para')]]</para></td>
            </tr>
            <tr>
                <td><para style="OBSERVACIONES">[[ ob.note and ob.note or removeParentNode('para') ]]</para></td>
            </tr>
        </blockTable>
    </section>

  </story>
</document>











