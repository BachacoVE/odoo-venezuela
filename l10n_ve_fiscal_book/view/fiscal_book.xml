<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record id="view_fiscal_book_lines_form" model="ir.ui.view">
            <field name="name">fiscal.book.lines.form</field>
            <field name="model">fiscal.book.lines</field>
            <field name="arch" type="xml">
                <form string="Fiscal Book Lines">
                    <field name='rank'/>
                    <field name='invoice_id'/>
                    <field name='get_date_imported'/>
                    <field name='get_date_invoiced'/>
                    <field name='get_t_doc'/>
                    <field name='get_partner_vat'/>
                    <field name='get_partner_name'/>
                    <field name='get_reference'/>
                    <field name='get_number'/>
                    <field name='get_doc'/>
                    <field name='get_debit_affected'/>
                    <field name='get_credit_affected'/>
                    <field name='get_parent'/>
                    <field name='fblt_ids'/>
                </form>
            </field>
        </record>

        <record id="view_fiscal_book_taxes_tree" model="ir.ui.view">
            <field name="name">fiscal.book.taxes.tree</field>
            <field name="model">fiscal.book.taxes</field>
            <field name="arch" type="xml">
                <tree string="Fiscal Taxes">
                        <field name="name"/>
                        <field name="base_amount"/>
                        <field name="tax_amount"/>
                </tree>
            </field>
        </record>

        <record id="view_fiscal_book_tree" model="ir.ui.view">
            <field name="name">fiscal.book.tree</field>
            <field name="model">fiscal.book</field>
            <field name="arch" type="xml">
                <tree string="Fiscal Book">
                    <field name="name"/>
                    <field name="period_id"/>
                    <field name="company_id"/>
                </tree>
            </field>
        </record>

        <record id="view_fiscal_book_lines_tree" model="ir.ui.view">
            <field name="name">fiscal.book.lines.tree</field>
            <field name="model">fiscal.book.lines</field>
            <field name="arch" type="xml">
                <tree string="Fiscal Book Lines">
                    <field name='rank'/>
                    <field name='invoice_id'/>
                    <field name='get_date_imported'/>
                    <field name='get_date_invoiced'/>
                    <field name='get_t_doc'/>
                    <field name='get_partner_vat'/>
                    <field name='get_partner_name'/>
                    <field name='get_reference'/>
                    <field name='get_number'/>
                    <field name='get_doc'/>
                    <field name='get_debit_affected'/>
                    <field name='get_credit_affected'/>
                    <field name='get_parent'/>
                    <field name='fblt_ids'/>
                </tree>
            </field>
        </record>

        <record id="view_fiscal_book_form" model="ir.ui.view">
            <field name="name">fiscal.book.form</field>
            <field name="model">fiscal.book</field>
            <field name="arch" type="xml">
                <form string="Fiscal Book" version="7.0">
                    <header>
                        <button name="update_book" type="object" string="Update Book" class="oe_highlight"/>
                        <button name="clear_book" type="object" string="Clear Book" class="oe_highlight"/>
                        <button name="%(fiscal_book_wizard_act)d" type="action" string="Print Book" class="oe_highlight"/>
                        <field name="state" widget="statusbar" statusbar_visible="draft,open,done" statusbar_colors='{"draft":"blue","open":"green","done":"red"}'/>
                    </header>
                    <group>
                        <field name="name"/>
                        <field name="type" readonly='1'/>
                        <field name="period_id" on_change="onchange_period_id()"/>
                        <field name="company_id" invisible='1'/>
                    </group>
                    <notebook colspan="8">
                        <page string="Fiscal Book Lines">
                            <label for="fbl_ids"/>
                            <button name="button_update_book_lines" type="object" string="Update" />
                            <button name="clear_book_lines" type="object" string="Clear"/>
                            <field name="fbl_ids" nolabel="1" colspan='4' readonly="True"/>
                        </page>
                        <page string="Fiscal Book Taxes">
                            <label for="fbt_ids"/>
                            <button name="button_update_book_taxes" type="object" string="Update" />
                            <button name="clear_book_taxes" type="object" string="Clear"/>
                            <field name="fbt_ids" colspan='4' readonly="True"/>
                        </page>
                        <page string="Fiscal Book Invoices">
                            <label for="invoice_ids"/>
                            <button name="button_update_book_invoices" type="object" string="Update"/>
                            <button name="clear_book_invoices" type="object" string="Clear"/>
                            <field name="invoice_ids" colspan='4' readonly="True"/>
                            <label for="issue_invoice_ids"/>
                            <button name="button_update_book_issue_invoices" type="object" string="Update"/>
                            <button name="clear_book_issue_invoices" type="object" string="Clear"/>
                            <field name="issue_invoice_ids" colspan='4' readonly="True"/>
                        </page>
                        <page string="Fiscal Book Vat Withholdings">
                            <label for="iwdl_ids"/>
                            <button name="button_update_book_wh_iva_lines" type="object" string="Update"/>
                            <button name="clear_book_iwdl_ids" type="object" string="Clear"/>
                            <field name="iwdl_ids" colspan='4' readonly="True"/>
                        </page>
                        <page string="Fiscal Book Adjustments">
                            <field name="abl_ids" nolabel="1" colspan='4'/>
                            <group col="8" colspan="8">
                                <field name="amount_total"/>
                                <field name="uncredit_fiscal_total"/>
                                <field name="amount_with_vat_total"/>
                                <field name="amount_untaxed_n_total"/>
                                <field name="amount_with_vat_n_total"/>
                                <field name="amount_untaxed_i_total"/>
                                <field name="amount_with_vat_i_total"/>
                            </group>
                            <group col="4" colspan="4">
                                <separator string="Explanation about this adjustment"/>
                                <newline/>
                                <field name="note" nolabel="1"/>
                            </group>
                        </page>
                        <page string="Adjustment Summary">
                            <notebook colspan="8">
                                <page string="Base Imponible" >
                                    <field name="no_grav" colspan="4"/>
                                    <group colspan="4" col="6">
                                        <group colspan="4" col="2">
                                        <separator string="Internacionales" colspan="4"/>
                                        <field name="vat_general_i" attrs="{'readonly':[('type','=','sale')]}"/>
                                        <field name="vat_general_add_i" attrs="{'readonly':[('type','=','sale')]}"/>
                                        <field name="vat_reduced_i" attrs="{'readonly':[('type','=','sale')]}"/>
                                        <field name="sale_export" attrs="{'readonly':[('type','=','purchase')]}"/>
                                        </group>
                                        <group colspan="1" col="2">
                                        <separator string="Nacionales" colspan="2"/>
                                        <field name="vat_general_n"/>
                                        <field name="vat_general_add_n"/>
                                        <field name="vat_reduced_n"/>
                                        </group>
                                        <group colspan="1" col="2">
                                        <separator string="Total y Ajuste" colspan="2"/>
                                        <field name="adjustment" colspan="4"/>
                                        <field name="amount_base_total" colspan="4"/>
                                        </group>
                                    </group>
                                </page>
                                <page string="Porcentaje Fiscal" >
                                    <field name="no_grav" colspan="4"/>
                                    <group colspan="4" col="6">
                                        <group colspan="4" col="2">
                                        <separator string="Internacionales" colspan="4"/>
                                        <field name="vat_general_icf" attrs="{'readonly':[('type','=','sale')]}"/>
                                        <field name="vat_general_add_icf" attrs="{'readonly':[('type','=','sale')]}"/>
                                        <field name="vat_reduced_icf" attrs="{'readonly':[('type','=','sale')]}"/>
                                        <field name="sale_export_cf" attrs="{'readonly':[('type','=','purchase')]}"/>
                                        </group>
                                        <group colspan="1" col="2">
                                        <separator string="Nacionales" colspan="2"/>
                                        <field name="vat_general_ncf"/>
                                        <field name="vat_general_add_ncf"/>
                                        <field name="vat_reduced_ncf"/>
                                        </group>
                                        <group colspan="1" col="2">
                                        <separator string="Total y Ajuste" colspan="2"/>
                                        <field name="adjustment_cf" colspan="4"/>
                                        <field name="amount_percent_total" colspan="4"/>
                                        </group>
                                    </group>
                                </page>
                            </notebook>
                        </page>
                    </notebook>
                    <group string='Total Taxing Base &amp; Total Taxed Amount' col='4'>
                        <field name="base_amount"/>
                        <field name="tax_amount"/>
                    </group>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>

      <record model="ir.actions.act_window" id="action_fiscal_sale_book">
            <field name="name">Fiscal Sale Book</field>
            <field name="res_model">fiscal.book</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'type':'sale'}</field>
            <field name="domain">[('type','=','sale')]</field>
        </record>
        
        <record model="ir.actions.act_window.view" id="action_fiscal_sale_book_tree">
            <field name="sequence" eval="10"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_fiscal_book_tree"/> 
            <field name="act_window_id" ref="action_fiscal_sale_book"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_fiscal_sale_book_form">
            <field name="sequence" eval="20"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_fiscal_book_form"/>
            <field name="act_window_id" ref="action_fiscal_sale_book"/>
        </record>
        
        <menuitem name="Fiscal Sale Book" 
            id="menu_fiscal_sale_book" 
            parent="menu_fr_main"
            action="action_fiscal_sale_book"/>

      <record model="ir.actions.act_window" id="action_fiscal_purchase_book">
            <field name="name">Fiscal Purchase Book</field>
            <field name="res_model">fiscal.book</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'type':'purchase'}</field>
            <field name="domain">[('type','=','purchase')]</field>
        </record>
        
        <record model="ir.actions.act_window.view" id="action_fiscal_purchase_book_tree">
            <field name="sequence" eval="10"/>
            <field name="view_mode">tree</field>
            <field name="view_id" ref="view_fiscal_book_tree"/> 
            <field name="act_window_id" ref="action_fiscal_purchase_book"/>
        </record>

        <record model="ir.actions.act_window.view" id="action_fiscal_purchase_book_form">
            <field name="sequence" eval="20"/>
            <field name="view_mode">form</field>
            <field name="view_id" ref="view_fiscal_book_form"/>
            <field name="act_window_id" ref="action_fiscal_purchase_book"/>
        </record>
        
        <menuitem name="Fiscal Purchase Book" 
            id="menu_fiscal_purchase_book" 
            parent="menu_fr_main"
            action="action_fiscal_purchase_book"/>

    </data>
</openerp>
