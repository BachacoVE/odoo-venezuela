-
  10. Test not withholdeable iva
-
  10.1 I update partner information
-
  !record {model: res.partner, id: base.res_partner_agrolait}:
    wh_iva_agent: True
    wh_iva_rate: 75
    vat_subjected: True
-
  10.2 I generate a withholding vat customer
-
  !record {model: account.wh.iva, id: wh_iva_test02}:
    journal_id: wh_sales_journal
    partner_id: base.res_partner_agrolait
    number: 222444333000
    account_id: account.a_recv
    name: 'IVA wh vat customer Agrolait test 2'
    type: out_invoice
-
  10.3 I check withholding vat customer
-
  !assert {model: account.wh.iva, id: wh_iva_test02, string: Wh was not saved}:
    - state == 'draft'
-
  10.4 I confirm the withholding vat customer
-
  !workflow {model: account.wh.iva, action: wh_iva_confirmed, ref: wh_iva_test02}
-
  10.5 I check withholding vat is not confirmed
-
  !assert {model: account.wh.iva, id: wh_iva_test02, string: Could not confirm the wh}:
    - state != 'confirmed'
-
  10.6 I try to mark it as done
-
  !workflow {model: account.wh.iva, action: wh_iva_done, ref: wh_iva_test01}
-
  10.7 I check withholding vat is not done
-
  !assert {model: account.wh.iva, id: wh_iva_test01, string: Wh cannot be in done state}:
    - state != 'done'
